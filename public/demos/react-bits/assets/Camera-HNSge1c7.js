import{T as m,aa as h,a6 as e}from"./index-CKqfvLoB.js";const f=new h,M=new e,l=new e;class y extends m{constructor(t,{near:s=.1,far:i=100,fov:r=45,aspect:n=1,left:a,right:o,bottom:u,top:p,zoom:c=1}={}){super(),Object.assign(this,{near:s,far:i,fov:r,aspect:n,left:a,right:o,bottom:u,top:p,zoom:c}),this.projectionMatrix=new h,this.viewMatrix=new h,this.projectionViewMatrix=new h,this.worldPosition=new e,this.type=a||o?"orthographic":"perspective",this.type==="orthographic"?this.orthographic():this.perspective()}perspective({near:t=this.near,far:s=this.far,fov:i=this.fov,aspect:r=this.aspect}={}){return Object.assign(this,{near:t,far:s,fov:i,aspect:r}),this.projectionMatrix.fromPerspective({fov:i*(Math.PI/180),aspect:r,near:t,far:s}),this.type="perspective",this}orthographic({near:t=this.near,far:s=this.far,left:i=this.left||-1,right:r=this.right||1,bottom:n=this.bottom||-1,top:a=this.top||1,zoom:o=this.zoom}={}){return Object.assign(this,{near:t,far:s,left:i,right:r,bottom:n,top:a,zoom:o}),i/=o,r/=o,n/=o,a/=o,this.projectionMatrix.fromOrthogonal({left:i,right:r,bottom:n,top:a,near:t,far:s}),this.type="orthographic",this}updateMatrixWorld(){return super.updateMatrixWorld(),this.viewMatrix.inverse(this.worldMatrix),this.worldMatrix.getTranslation(this.worldPosition),this.projectionViewMatrix.multiply(this.projectionMatrix,this.viewMatrix),this}updateProjectionMatrix(){return this.type==="perspective"?this.perspective():this.orthographic()}lookAt(t){return super.lookAt(t,!0),this}project(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this}unproject(t){return t.applyMatrix4(f.inverse(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this}updateFrustum(){this.frustum||(this.frustum=[new e,new e,new e,new e,new e,new e]);const t=this.projectionViewMatrix;this.frustum[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).constant=t[15]-t[12],this.frustum[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).constant=t[15]+t[12],this.frustum[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).constant=t[15]+t[13],this.frustum[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).constant=t[15]-t[13],this.frustum[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).constant=t[15]-t[14],this.frustum[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).constant=t[15]+t[14];for(let s=0;s<6;s++){const i=1/this.frustum[s].distance();this.frustum[s].multiply(i),this.frustum[s].constant*=i}}frustumIntersectsMesh(t,s=t.worldMatrix){if(!t.geometry.attributes.position||((!t.geometry.bounds||t.geometry.bounds.radius===1/0)&&t.geometry.computeBoundingSphere(),!t.geometry.bounds))return!0;const i=M;i.copy(t.geometry.bounds.center),i.applyMatrix4(s);const r=t.geometry.bounds.radius*s.getMaxScaleOnAxis();return this.frustumIntersectsSphere(i,r)}frustumIntersectsSphere(t,s){const i=l;for(let r=0;r<6;r++){const n=this.frustum[r];if(i.copy(n).dot(t)+n.constant<-s)return!1}return!0}}export{y as C};
