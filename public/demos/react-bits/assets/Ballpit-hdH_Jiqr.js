var Be=Object.defineProperty;var de=i=>{throw TypeError(i)};var Ie=(i,t,e)=>t in i?Be(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var v=(i,t,e)=>Ie(i,typeof t!="symbol"?t+"":t,e),te=(i,t,e)=>t.has(i)||de("Cannot "+e);var a=(i,t,e)=>(te(i,t,"read from private field"),e?e.call(i):t.get(i)),x=(i,t,e)=>t.has(i)?de("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),R=(i,t,e,s)=>(te(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e),d=(i,t,e)=>(te(i,t,"access private method"),e);import{r as ie,j as Fe}from"./index-CKqfvLoB.js";import{S as xe,br as Ne,aE as me,be as Oe,ap as be,M as b,z as _e,A as Ve,R as We,b2 as Ye,m as z,n as je,d as He,W as Te,i as Xe,b as ae,V as re,ar as Ue,bs as Ge,bt as Ze,b6 as qe,C as fe,D as Je,an as Ke,bc as Qe}from"./three.module-DbwSNGae.js";class $e extends xe{constructor(t=null){super();const e=new Ne;e.deleteAttribute("uv");const s=new me({side:Oe}),n=new me,m=new be(16777215,900,28,2);m.position.set(.418,16.199,.3),this.add(m);const l=new b(e,s);l.position.set(-.757,13.219,.717),l.scale.set(31.713,28.305,28.591),this.add(l);const g=new b(e,n);g.position.set(-10.906,2.009,1.846),g.rotation.set(0,-.195,0),g.scale.set(2.328,7.905,4.651),this.add(g);const h=new b(e,n);h.position.set(-5.607,-.754,-.758),h.rotation.set(0,.994,0),h.scale.set(1.97,1.534,3.955),this.add(h);const c=new b(e,n);c.position.set(6.167,.857,7.803),c.rotation.set(0,.561,0),c.scale.set(3.927,6.285,3.687),this.add(c);const r=new b(e,n);r.position.set(-2.017,.018,6.124),r.rotation.set(0,.333,0),r.scale.set(2.002,4.566,2.064),this.add(r);const M=new b(e,n);M.position.set(2.291,-.756,-2.621),M.rotation.set(0,-.286,0),M.scale.set(1.546,1.552,1.496),this.add(M);const p=new b(e,n);p.position.set(-2.193,-.369,-5.547),p.rotation.set(0,.516,0),p.scale.set(3.875,3.487,2.986),this.add(p);const y=new b(e,I(50));y.position.set(-16.116,14.37,8.208),y.scale.set(.1,2.428,2.739),this.add(y);const A=new b(e,I(50));A.position.set(-16.109,18.021,-8.207),A.scale.set(.1,2.425,2.751),this.add(A);const k=new b(e,I(17));k.position.set(14.904,12.198,-1.832),k.scale.set(.15,4.265,6.331),this.add(k);const B=new b(e,I(43));B.position.set(-.462,8.89,14.52),B.scale.set(4.38,5.441,.088),this.add(B);const j=new b(e,I(20));j.position.set(3.235,11.486,-12.541),j.scale.set(2.5,2,.1),this.add(j);const ee=new b(e,I(100));ee.position.set(0,20,0),ee.scale.set(1,.1,1),this.add(ee)}dispose(){const t=new Set;this.traverse(e=>{e.isMesh&&(t.add(e.geometry),t.add(e.material))});for(const e of t)e.dispose()}}function I(i){const t=new _e;return t.color.setScalar(i),t}var w,D,O,P,_,V,W,Y,C,H,o,ze,Me,Ae,Se,Re,Le,ce,Z,Ee,he,Ce,le,q,De;class et{constructor(t){x(this,o);x(this,w);v(this,"canvas");v(this,"camera");v(this,"cameraMinAspect");v(this,"cameraMaxAspect");v(this,"cameraFov");v(this,"maxPixelRatio");v(this,"minPixelRatio");v(this,"scene");v(this,"renderer");x(this,D);v(this,"size",{width:0,height:0,wWidth:0,wHeight:0,ratio:0,pixelRatio:0});v(this,"render",d(this,o,De));v(this,"onBeforeRender",()=>{});v(this,"onAfterRender",()=>{});v(this,"onAfterResize",()=>{});x(this,O,!1);x(this,P,!1);v(this,"isDisposed",!1);x(this,_);x(this,V);x(this,W);x(this,Y,new je);x(this,C,{elapsed:0,delta:0});x(this,H);R(this,w,{...t}),d(this,o,ze).call(this),d(this,o,Me).call(this),d(this,o,Ae).call(this),this.resize(),d(this,o,Se).call(this)}resize(){let t,e;a(this,w).size instanceof Object?(t=a(this,w).size.width,e=a(this,w).size.height):a(this,w).size==="parent"&&this.canvas.parentNode?(t=this.canvas.parentNode.offsetWidth,e=this.canvas.parentNode.offsetHeight):(t=window.innerWidth,e=window.innerHeight),this.size.width=t,this.size.height=e,this.size.ratio=t/e,d(this,o,Ee).call(this),d(this,o,Ce).call(this),this.onAfterResize(this.size)}updateWorldSize(){if(this.camera.isPerspectiveCamera){const t=this.camera.fov*Math.PI/180;this.size.wHeight=2*Math.tan(t/2)*this.camera.position.length(),this.size.wWidth=this.size.wHeight*this.camera.aspect}else this.camera.isOrthographicCamera&&(this.size.wHeight=this.camera.top-this.camera.bottom,this.size.wWidth=this.camera.right-this.camera.left)}get postprocessing(){return a(this,D)}set postprocessing(t){R(this,D,t),this.render=t.render.bind(t)}clear(){this.scene.traverse(t=>{t.isMesh&&typeof t.material=="object"&&t.material!==null&&(Object.keys(t.material).forEach(e=>{const s=t.material[e];s!==null&&typeof s=="object"&&typeof s.dispose=="function"&&s.dispose()}),t.material.dispose(),t.geometry.dispose())}),this.scene.clear()}dispose(){var t;d(this,o,Re).call(this),d(this,o,q).call(this),this.clear(),(t=a(this,D))==null||t.dispose(),this.renderer.dispose(),this.isDisposed=!0}}w=new WeakMap,D=new WeakMap,O=new WeakMap,P=new WeakMap,_=new WeakMap,V=new WeakMap,W=new WeakMap,Y=new WeakMap,C=new WeakMap,H=new WeakMap,o=new WeakSet,ze=function(){this.camera=new He,this.cameraFov=this.camera.fov},Me=function(){this.scene=new xe},Ae=function(){a(this,w).canvas?this.canvas=a(this,w).canvas:a(this,w).id?this.canvas=document.getElementById(a(this,w).id):console.error("Three: Missing canvas or id parameter"),this.canvas.style.display="block";const t={canvas:this.canvas,powerPreference:"high-performance",...a(this,w).rendererOptions??{}};this.renderer=new Te(t),this.renderer.outputColorSpace=Xe},Se=function(){a(this,w).size instanceof Object||(window.addEventListener("resize",d(this,o,Z).bind(this)),a(this,w).size==="parent"&&this.canvas.parentNode&&(R(this,V,new ResizeObserver(d(this,o,Z).bind(this))),a(this,V).observe(this.canvas.parentNode))),R(this,_,new IntersectionObserver(d(this,o,Le).bind(this),{root:null,rootMargin:"0px",threshold:0})),a(this,_).observe(this.canvas),document.addEventListener("visibilitychange",d(this,o,ce).bind(this))},Re=function(){var t,e;window.removeEventListener("resize",d(this,o,Z).bind(this)),(t=a(this,V))==null||t.disconnect(),(e=a(this,_))==null||e.disconnect(),document.removeEventListener("visibilitychange",d(this,o,ce).bind(this))},Le=function(t){R(this,O,t[0].isIntersecting),a(this,O)?d(this,o,le).call(this):d(this,o,q).call(this)},ce=function(){a(this,O)&&(document.hidden?d(this,o,q).call(this):d(this,o,le).call(this))},Z=function(){a(this,W)&&clearTimeout(a(this,W)),R(this,W,setTimeout(this.resize.bind(this),100))},Ee=function(){this.camera.aspect=this.size.width/this.size.height,this.camera.isPerspectiveCamera&&this.cameraFov&&(this.cameraMinAspect&&this.camera.aspect<this.cameraMinAspect?d(this,o,he).call(this,this.cameraMinAspect):this.cameraMaxAspect&&this.camera.aspect>this.cameraMaxAspect?d(this,o,he).call(this,this.cameraMaxAspect):this.camera.fov=this.cameraFov),this.camera.updateProjectionMatrix(),this.updateWorldSize()},he=function(t){const e=Math.tan(ae.degToRad(this.cameraFov/2))/(this.camera.aspect/t);this.camera.fov=2*ae.radToDeg(Math.atan(e))},Ce=function(){var e;this.renderer.setSize(this.size.width,this.size.height),(e=a(this,D))==null||e.setSize(this.size.width,this.size.height);let t=window.devicePixelRatio;this.maxPixelRatio&&t>this.maxPixelRatio?t=this.maxPixelRatio:this.minPixelRatio&&t<this.minPixelRatio&&(t=this.minPixelRatio),this.renderer.setPixelRatio(t),this.size.pixelRatio=t},le=function(){if(a(this,P))return;const t=()=>{R(this,H,requestAnimationFrame(t)),a(this,C).delta=a(this,Y).getDelta(),a(this,C).elapsed+=a(this,C).delta,this.onBeforeRender(a(this,C)),this.render(),this.onAfterRender(a(this,C))};R(this,P,!0),a(this,Y).start(),t()},q=function(){a(this,P)&&(cancelAnimationFrame(a(this,H)),R(this,P,!1),a(this,Y).stop())},De=function(){this.renderer.render(this.scene,this.camera)};const L=new Map,S=new re;let se=!1;function tt(i){const t={position:new re,nPosition:new re,hover:!1,touching:!1,onEnter(){},onMove(){},onClick(){},onLeave(){},...i};return function(e,s){L.has(e)||(L.set(e,s),se||(document.body.addEventListener("pointermove",ue),document.body.addEventListener("pointerleave",ge),document.body.addEventListener("click",pe),document.body.addEventListener("touchstart",ve,{passive:!1}),document.body.addEventListener("touchmove",ye,{passive:!1}),document.body.addEventListener("touchend",T,{passive:!1}),document.body.addEventListener("touchcancel",T,{passive:!1}),se=!0))}(i.domElement,t),t.dispose=()=>{const e=i.domElement;L.delete(e),L.size===0&&(document.body.removeEventListener("pointermove",ue),document.body.removeEventListener("pointerleave",ge),document.body.removeEventListener("click",pe),document.body.removeEventListener("touchstart",ve),document.body.removeEventListener("touchmove",ye),document.body.removeEventListener("touchend",T),document.body.removeEventListener("touchcancel",T),se=!1)},t}function ue(i){S.x=i.clientX,S.y=i.clientY,it()}function it(){for(const[i,t]of L){const e=i.getBoundingClientRect();$(e)?(Q(t,e),t.hover||(t.hover=!0,t.onEnter(t)),t.onMove(t)):t.hover&&!t.touching&&(t.hover=!1,t.onLeave(t))}}function pe(i){S.x=i.clientX,S.y=i.clientY;for(const[t,e]of L){const s=t.getBoundingClientRect();Q(e,s),$(s)&&e.onClick(e)}}function ge(){for(const i of L.values())i.hover&&(i.hover=!1,i.onLeave(i))}function ve(i){if(i.touches.length>0){i.preventDefault(),S.x=i.touches[0].clientX,S.y=i.touches[0].clientY;for(const[t,e]of L){const s=t.getBoundingClientRect();$(s)&&(e.touching=!0,Q(e,s),e.hover||(e.hover=!0,e.onEnter(e)),e.onMove(e))}}}function ye(i){if(i.touches.length>0){i.preventDefault(),S.x=i.touches[0].clientX,S.y=i.touches[0].clientY;for(const[t,e]of L){const s=t.getBoundingClientRect();Q(e,s),$(s)?(e.hover||(e.hover=!0,e.touching=!0,e.onEnter(e)),e.onMove(e)):e.hover&&e.touching&&e.onMove(e)}}}function T(){for(const[,i]of L)i.touching&&(i.touching=!1,i.hover&&(i.hover=!1,i.onLeave(i)))}function Q(i,t){const{position:e,nPosition:s}=i;e.x=S.x-t.left,e.y=S.y-t.top,s.x=e.x/t.width*2-1,s.y=-e.y/t.height*2+1}function $(i){const{x:t,y:e}=S,{left:s,top:n,width:m,height:l}=i;return t>=s&&t<=s+m&&e>=n&&e<=n+l}const{randFloat:st,randFloatSpread:ne}=ae,oe=new z,f=new z,X=new z,nt=new z,u=new z,U=new z,F=new z,E=new z,G=new z,we=new z;var J,Pe;class ot{constructor(t){x(this,J);this.config=t,this.positionData=new Float32Array(3*t.count).fill(0),this.velocityData=new Float32Array(3*t.count).fill(0),this.sizeData=new Float32Array(t.count).fill(1),this.center=new z,d(this,J,Pe).call(this),this.setSizes()}setSizes(){const{config:t,sizeData:e}=this;e[0]=t.size0;for(let s=1;s<t.count;s++)e[s]=st(t.minSize,t.maxSize)}update(t){const{config:e,center:s,positionData:n,sizeData:m,velocityData:l}=this;let g=0;e.controlSphere0&&(g=1,oe.fromArray(n,0),oe.lerp(s,.1).toArray(n,0),nt.set(0,0,0).toArray(l,0));for(let h=g;h<e.count;h++){const c=3*h;f.fromArray(n,c),u.fromArray(l,c),u.y-=t.delta*e.gravity*m[h],u.multiplyScalar(e.friction),u.clampLength(0,e.maxVelocity),f.add(u),f.toArray(n,c),u.toArray(l,c)}for(let h=g;h<e.count;h++){const c=3*h;f.fromArray(n,c),u.fromArray(l,c);const r=m[h];for(let p=h+1;p<e.count;p++){const y=3*p;X.fromArray(n,y),U.fromArray(l,y);const A=m[p];F.copy(X).sub(f);const k=F.length(),B=r+A;if(k<B){const j=B-k;E.copy(F).normalize().multiplyScalar(.5*j),G.copy(E).multiplyScalar(Math.max(u.length(),1)),we.copy(E).multiplyScalar(Math.max(U.length(),1)),f.sub(E),u.sub(G),f.toArray(n,c),u.toArray(l,c),X.add(E),U.add(we),X.toArray(n,y),U.toArray(l,y)}}if(e.controlSphere0){F.copy(oe).sub(f);const p=F.length(),y=r+m[0];if(p<y){const A=y-p;E.copy(F.normalize()).multiplyScalar(A),G.copy(E).multiplyScalar(Math.max(u.length(),2)),f.sub(E),u.sub(G)}}Math.abs(f.x)+r>e.maxX&&(f.x=Math.sign(f.x)*(e.maxX-r),u.x=-u.x*e.wallBounce),e.gravity===0?Math.abs(f.y)+r>e.maxY&&(f.y=Math.sign(f.y)*(e.maxY-r),u.y=-u.y*e.wallBounce):f.y-r<-e.maxY&&(f.y=-e.maxY+r,u.y=-u.y*e.wallBounce);const M=Math.max(e.maxZ,e.maxSize);Math.abs(f.z)+r>M&&(f.z=Math.sign(f.z)*(e.maxZ-r),u.z=-u.z*e.wallBounce),f.toArray(n,c),u.toArray(l,c)}}}J=new WeakSet,Pe=function(){const{config:t,positionData:e}=this;this.center.toArray(e,0);for(let s=1;s<t.count;s++){const n=3*s;e[n]=ne(2*t.maxX),e[n+1]=ne(2*t.maxY),e[n+2]=ne(2*t.maxZ)}};class at extends Ke{constructor(t){super(t),this.uniforms={thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}},this.defines.USE_UV="",this.onBeforeCompile=e=>{Object.assign(e.uniforms,this.uniforms),e.fragmentShader=`
        uniform float thicknessPower;
        uniform float thicknessScale;
        uniform float thicknessDistortion;
        uniform float thicknessAmbient;
        uniform float thicknessAttenuation;
      `+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("void main() {",`
        void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, inout ReflectedLight reflectedLight) {
          vec3 scatteringHalf = normalize(directLight.direction + (geometryNormal * thicknessDistortion));
          float scatteringDot = pow(saturate(dot(geometryViewDir, -scatteringHalf)), thicknessPower) * thicknessScale;
          #ifdef USE_COLOR
            vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * vColor;
          #else
            vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * diffuse;
          #endif
          reflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;
        }

        void main() {
      `);const s=Qe.lights_fragment_begin.replaceAll("RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );",`
          RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
          RE_Direct_Scattering(directLight, vUv, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, reflectedLight);
        `);e.fragmentShader=e.fragmentShader.replace("#include <lights_fragment_begin>",s),this.onBeforeCompile2&&this.onBeforeCompile2(e)}}}const rt={count:200,colors:[0,0,0],ambientColor:16777215,ambientIntensity:1,lightIntensity:200,materialParams:{metalness:.5,roughness:.5,clearcoat:1,clearcoatRoughness:.15},minSize:.5,maxSize:1,size0:1,gravity:.5,friction:.9975,wallBounce:.95,maxVelocity:.15,maxX:5,maxY:5,maxZ:2,controlSphere0:!1,followCursor:!0},N=new Je;var K,ke;class ct extends Ue{constructor(e,s={}){const n={...rt,...s},m=new $e,l=new Ge(e,.04).fromScene(m).texture,g=new Ze,h=new at({envMap:l,...n.materialParams});h.envMapRotation.x=-Math.PI/2;super(g,h,n.count);x(this,K);this.config=n,this.physics=new ot(n),d(this,K,ke).call(this),this.setColors(n.colors)}setColors(e){if(Array.isArray(e)&&e.length>1){const s=function(n){let m,l;function g(h){m=h,l=[],m.forEach(c=>{l.push(new fe(c))})}return g(n),{setColors:g,getColorAt:function(h,c=new fe){const r=Math.max(0,Math.min(1,h))*(m.length-1),M=Math.floor(r),p=l[M];if(M>=m.length-1)return p.clone();const y=r-M,A=l[M+1];return c.r=p.r+y*(A.r-p.r),c.g=p.g+y*(A.g-p.g),c.b=p.b+y*(A.b-p.b),c}}}(e);for(let n=0;n<this.count;n++)this.setColorAt(n,s.getColorAt(n/this.count)),n===0&&this.light.color.copy(s.getColorAt(n/this.count));this.instanceColor.needsUpdate=!0}}update(e){this.physics.update(e);for(let s=0;s<this.count;s++)N.position.fromArray(this.physics.positionData,3*s),s===0&&this.config.followCursor===!1?N.scale.setScalar(0):N.scale.setScalar(this.physics.sizeData[s]),N.updateMatrix(),this.setMatrixAt(s,N.matrix),s===0&&this.light.position.copy(N.position);this.instanceMatrix.needsUpdate=!0}}K=new WeakSet,ke=function(){this.ambientLight=new qe(this.config.ambientColor,this.config.ambientIntensity),this.add(this.ambientLight),this.light=new be(this.config.colors[0],this.config.lightIntensity),this.add(this.light)};function ht(i,t={}){const e=new et({canvas:i,size:"parent",rendererOptions:{antialias:!0,alpha:!0}});let s;e.renderer.toneMapping=Ve,e.camera.position.set(0,0,20),e.camera.lookAt(0,0,0),e.cameraMaxAspect=1.5,e.resize(),c(t);const n=new We,m=new Ye(new z(0,0,1),0),l=new z;let g=!1;i.style.touchAction="none",i.style.userSelect="none",i.style.webkitUserSelect="none";const h=tt({domElement:i,onMove(){n.setFromCamera(h.nPosition,e.camera),e.camera.getWorldDirection(m.normal),n.ray.intersectPlane(m,l),s.physics.center.copy(l),s.config.controlSphere0=!0},onLeave(){s.config.controlSphere0=!1}});function c(r){s&&(e.clear(),e.scene.remove(s)),s=new ct(e.renderer,r),e.scene.add(s)}return e.onBeforeRender=r=>{g||s.update(r)},e.onAfterResize=r=>{s.config.maxX=r.wWidth/2,s.config.maxY=r.wHeight/2},{three:e,get spheres(){return s},setCount(r){c({...s.config,count:r})},togglePause(){g=!g},dispose(){h.dispose(),e.dispose()}}}const ft=({className:i="",followCursor:t=!0,...e})=>{const s=ie.useRef(null),n=ie.useRef(null);return ie.useEffect(()=>{const m=s.current;if(m)return n.current=ht(m,{followCursor:t,...e}),()=>{n.current&&n.current.dispose()}},[]),Fe.jsx("canvas",{className:i,ref:s,style:{width:"100%",height:"100%"}})};export{ft as default};
