import{v as x,w as I,r as u,x as S,j as e,y as a}from"./index-CuoSW9a6.js";const D="_controls_uyjqd_6",$="_title_uyjqd_11",B="_stats_uyjqd_13",E="_statsSep_uyjqd_17",T="_content_uyjqd_19",M="_viewGroup_uyjqd_21",H="_groupHeader_uyjqd_22",P="_sessionName_uyjqd_23",R="_label_uyjqd_24",z="_sid_uyjqd_25",G="_itemCount_uyjqd_26",U="_table_uyjqd_28",K="_pos_uyjqd_34",L="_text_uyjqd_36",Q="_date_uyjqd_37",F="_deleteBtn_uyjqd_38",s={controls:D,title:$,stats:B,statsSep:E,content:T,viewGroup:M,groupHeader:H,sessionName:P,label:R,sid:z,itemCount:G,table:U,pos:K,text:L,date:Q,deleteBtn:F};let O=Date.now();function V(){return O++}function W(o){return new Date(o).toLocaleTimeString("en-US",{hour12:!1})}function J(){const o=x(t=>t.queues),v=x(t=>t.add),w=x(t=>t.remove),y=x(t=>t.moveToSession),h=I(t=>t.sessions),[r,k]=u.useState(""),[p,b]=u.useState(""),[d,g]=u.useState(null),m=Array.from(new Set([...o.keys(),...h.keys()])).filter(t=>{const n=o.get(t);return n&&n.length>0}),f=Array.from(o.values()).reduce((t,n)=>t+n.length,0),q=u.useCallback(()=>{const t=p.trim();if(!t||!r)return;const n=o.get(r)??[],i={id:V(),sessionId:r,text:t,position:n.length,createdAt:Date.now()};v(r,i),b(""),S("Prompt added to queue","info",2e3)},[p,r,o,v]),A=u.useCallback(t=>{d&&(y([d.itemId],d.fromSessionId,t),g(null),S("Prompt moved","info",2e3))},[d,y]),N=Array.from(h.entries());return e.jsxs("div",{"data-testid":"queue-view",style:{height:"100%",overflow:"auto"},children:[e.jsx("div",{className:s.controls,children:e.jsx("h2",{className:s.title,children:"PROMPT QUEUE"})}),e.jsxs("div",{className:s.stats,children:[e.jsxs("span",{children:[f," queued prompt",f!==1?"s":""]}),e.jsx("span",{className:s.statsSep,children:"|"}),e.jsxs("span",{children:[m.length," session",m.length!==1?"s":""]})]}),e.jsx("div",{style:{padding:"0 24px 16px"},children:e.jsxs("div",{className:a.queueCompose,children:[e.jsxs("select",{value:r,onChange:t=>k(t.target.value),style:{background:"rgba(255,255,255,0.04)",border:"1px solid var(--border-subtle, rgba(255,255,255,0.08))",borderRadius:"4px",color:"var(--text-primary)",fontFamily:"var(--font-mono)",fontSize:"11px",padding:"6px 8px",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select session..."}),N.map(([t,n])=>e.jsxs("option",{value:t,children:[n.projectName||t.slice(0,8),n.title?` — ${n.title}`:""]},t))]}),e.jsx("textarea",{className:a.queueTextarea,placeholder:"Add a prompt to the queue...",rows:2,value:p,onChange:t=>b(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),q())}}),e.jsx("button",{className:`${a.toolbarBtn} ${a.queueAddBtn}`,onClick:q,disabled:!p.trim()||!r,children:"ADD"})]})}),e.jsx("div",{className:s.content,children:m.length===0?e.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"var(--text-dim)",fontSize:"13px"},children:"No prompts in queue. Add prompts from session detail panels or above."}):m.map(t=>{const n=o.get(t)??[],i=h.get(t);return e.jsxs("div",{className:s.viewGroup,children:[e.jsxs("div",{className:s.groupHeader,children:[e.jsx("span",{className:s.sessionName,children:i?.projectName||"Unknown"}),i?.label&&e.jsx("span",{className:s.label,children:i.label}),e.jsx("span",{className:s.sid,children:t.slice(0,8)}),e.jsxs("span",{className:s.itemCount,children:[n.length," item",n.length!==1?"s":""]})]}),e.jsxs("table",{className:s.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:s.pos,children:"#"}),e.jsx("th",{children:"Prompt"}),e.jsx("th",{children:"Added"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map((l,C)=>e.jsxs("tr",{children:[e.jsx("td",{className:s.pos,children:C+1}),e.jsx("td",{className:s.text,children:l.text}),e.jsx("td",{className:s.date,children:W(l.createdAt)}),e.jsxs("td",{children:[e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsx("button",{className:`${a.queueActionBtn} ${a.queueMove}`,onClick:()=>g(d?.itemId===l.id?null:{itemId:l.id,fromSessionId:t}),children:"MOVE"}),e.jsx("button",{className:`${a.queueActionBtn} ${a.queueDelete} ${s.deleteBtn}`,onClick:()=>w(t,l.id),children:"DEL"})]}),d?.itemId===l.id&&e.jsx("div",{style:{position:"absolute",zIndex:10,background:"var(--surface-card, #12122a)",border:"1px solid var(--border-subtle, rgba(255,255,255,0.08))",borderRadius:"4px",padding:"4px",maxHeight:"160px",overflowY:"auto",minWidth:"180px"},children:N.filter(([c])=>c!==t).map(([c,j])=>e.jsxs("button",{onClick:()=>A(c),style:{display:"block",width:"100%",padding:"4px 8px",background:"transparent",border:"none",color:"var(--text-primary)",fontFamily:"var(--font-mono)",fontSize:"10px",textAlign:"left",cursor:"pointer",borderRadius:"3px"},onMouseEnter:_=>{_.target.style.background="rgba(0,229,255,0.1)"},onMouseLeave:_=>{_.target.style.background="transparent"},children:[j.projectName||c.slice(0,8),j.title?` — ${j.title}`:""]},c))})]})]},l.id))})]})]},t)})})]})}export{J as default};
